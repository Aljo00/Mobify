<%- include('../../views/layout/header.ejs')%>

<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<!-- Font Awesome -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
/>
<!-- Custom CSS -->
<link rel="stylesheet" href="/styles/user/shop.css" />

<div class="container-fluid mt-5">
  <div class="row">
    <!-- Filters Section -->
    <div class="col-md-3">
      <div class="filters-section">
        <h3>Filters</h3>
        <form id="filtersForm">
          <div class="mb-3">
            <label for="category" class="form-label">Category</label>
            <select class="form-select" id="category" name="category">
              <option value="">All Categories</option>
              <% categories.forEach(category => { %>
              <option value="<%= category.id %>"><%= category.name %></option>
              <% }) %>
            </select>
          </div>
          <div class="mb-3">
            <label for="priceRange" class="form-label">Price Range</label>
            <input
              type="range"
              class="form-range"
              id="priceRange"
              name="priceRange"
              min="0"
              max="1000"
              step="10"
            />
          </div>
          <button type="submit" class="btn btn-primary">Apply Filters</button>
        </form>
      </div>
    </div>
    <!-- Products Section -->
    <div class="col-md-9">
      <div class="product__filter-wrapper">
        <div class="product__filter row">
          <% for (let i = 0; i < products.length; i++) { %>
          <div class="col-lg-3 col-md-3 col-sm-6 col-12 mix new-arrivals mb-4">
            <div class="product__item compact">
              <a href="/product/<%= products[i]._id %>">
                <div
                  class="product__item__pic"
                  style="
                    background-image: url('<%= products[i].productImage[0] %>');
                  "
                >
                  <img
                    src="<%= products[i].productImage[1] %>"
                    class="hover-image"
                    alt="Second Image"
                  />
                </div>
              </a>
              <div class="product__item__text">
                <h6 class="product-name"><%= products[i].productName %></h6>
                <h5 class="product-price">
                  ₹<%= products[i].combos[0].salePrice.toLocaleString() %>
                  <span class="text-muted">
                    <del
                      >₹<%= products[i].combos[0].regularPrice.toLocaleString()
                      %></del
                    >
                  </span>
                  <% if (products[i].combos[0].regularPrice >
                  products[i].combos[0].salePrice) { %>
                  <span class="product-discount">
                    -<%= Math.round(((products[i].combos[0].regularPrice -
                    products[i].combos[0].salePrice) /
                    products[i].combos[0].regularPrice) * 100) %>%
                  </span>
                  <% } %>
                </h5>
                <div class="action-buttons">
                  <% if (products[i].combos[0].quantity !== 0){%>
                  <a
                    href="/addToCart?id=<%= products[i]._id %>"
                    class="add-cart"
                    data-id="<%= products[i]._id %>"
                    >Add To Cart</a
                  >
                  <% } else {%>
                  <span class="add-cart" style="background-color: red"
                    >Out of Stock</span
                  >
                  <% } %>
                  <a
                    href="/addToWishlist?id=<%= products[i]._id %>"
                    class="wishlist-btn"
                  >
                    <i class="fa fa-heart"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- <script src="/scripts/user/shop.js"></script> -->

<%- include('../../views/layout/footer.ejs') %>
